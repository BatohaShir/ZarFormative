//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum UserRole {
  admin
  manager
  user
}

enum ListingStatus {
  draft
  active
  paused
  archived
  deleted
}

enum AimagType {
  aimag
  capital
}

enum DistrictType {
  duureg
  sum
}

model categories {
  id         String       @id() @default(cuid())
  slug       String       @unique()
  name       String
  icon       String?
  parent_id  String?
  parent     categories?  @relation("CategoryHierarchy", fields: [parent_id], references: [id])
  children   categories[] @relation("CategoryHierarchy")
  sort_order Int          @default(0)
  is_active  Boolean      @default(true)
  created_at DateTime     @default(now())
  updated_at DateTime     @updatedAt()
  listings   listings[]

  @@index([parent_id])
  @@index([slug])
  @@index([is_active, sort_order])
  @@map("categories")
}

model profiles {
  id                    String                          @id() @db.Uuid()
  first_name            String?
  last_name             String?
  phone_number          String?
  is_company            Boolean                         @default(false)
  avatar_url            String?
  about                 String?
  role                  UserRole                        @default(user)
  created_at            DateTime                        @default(now())
  updated_at            DateTime                        @default(now())
  company_name          String?
  registration_number   String?
  is_deleted            Boolean                         @default(false)
  push_subscriptions    profiles_push_subscriptions[]
  notification_settings profiles_notification_settings?
  educations            profiles_educations[]
  work_experiences      profiles_work_experiences[]
  listings              listings[]

  @@index([is_deleted])
  @@index([is_company])
  @@index([created_at])
  @@index([role])
  @@map("profiles")
}

model profiles_push_subscriptions {
  id         String    @id() @default(uuid()) @db.Uuid()
  user_id    String    @db.Uuid()
  endpoint   String
  p256dh     String?
  auth       String?
  expires_at DateTime?
  created_at DateTime  @default(now())
  updated_at DateTime  @default(now())
  profile    profiles  @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([user_id, endpoint])
  @@index([user_id])
  @@map("profiles_push_subscriptions")
}

model profiles_notification_settings {
  id                     String   @id() @default(uuid()) @db.Uuid()
  user_id                String   @unique() @db.Uuid()
  push_enabled           Boolean  @default(false)
  push_new_requests      Boolean  @default(true)
  push_new_messages      Boolean  @default(true)
  push_status_changes    Boolean  @default(true)
  email_enabled          Boolean  @default(true)
  email_new_requests     Boolean  @default(true)
  email_new_messages     Boolean  @default(true)
  email_digest           Boolean  @default(true)
  email_digest_frequency String   @default("daily")
  quiet_hours_enabled    Boolean  @default(false)
  quiet_hours_start      String   @default("22:00")
  quiet_hours_end        String   @default("08:00")
  created_at             DateTime @default(now())
  updated_at             DateTime @default(now())
  profile                profiles @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("profiles_notification_settings")
}

model profiles_educations {
  id             String    @id() @default(uuid()) @db.Uuid()
  user_id        String    @db.Uuid()
  degree         String
  institution    String
  field_of_study String?
  start_date     DateTime
  end_date       DateTime?
  is_current     Boolean   @default(false)
  created_at     DateTime  @default(now())
  updated_at     DateTime  @default(now())
  user           profiles  @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id])
  @@index([user_id, start_date(sort: Desc)])
  @@map("profiles_educations")
}

model profiles_work_experiences {
  id          String    @id() @default(uuid()) @db.Uuid()
  user_id     String    @db.Uuid()
  company     String
  position    String
  description String?
  start_date  DateTime
  end_date    DateTime?
  is_current  Boolean   @default(false)
  created_at  DateTime  @default(now())
  updated_at  DateTime  @default(now())
  user        profiles  @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([user_id])
  @@index([user_id, start_date(sort: Desc)])
  @@map("profiles_work_experiences")
}

model listings {
  id            String            @id() @default(cuid())
  user_id       String            @db.Uuid()
  category_id   String
  title         String
  slug          String            @unique()
  description   String            @db.Text()
  price         Decimal?          @db.Decimal(12, 2)
  currency      String            @default("MNT")
  is_negotiable Boolean           @default(false)
  city          String
  district      String?
  address       String?
  latitude      Decimal?          @db.Decimal(10, 7)
  longitude     Decimal?          @db.Decimal(10, 7)
  status        ListingStatus     @default(draft)
  is_active     Boolean           @default(true)
  views_count   Int               @default(0)
  created_at    DateTime          @default(now())
  updated_at    DateTime          @updatedAt()
  published_at  DateTime?
  user          profiles          @relation(fields: [user_id], references: [id], onDelete: Cascade)
  category      categories        @relation(fields: [category_id], references: [id])
  images        listings_images[]

  @@index([user_id])
  @@index([category_id])
  @@index([status, is_active])
  @@index([city])
  @@index([city, district])
  @@index([created_at(sort: Desc)])
  @@index([status, city, category_id])
  @@index([slug])
  @@map("listings")
}

model listings_images {
  id         String   @id() @default(uuid()) @db.Uuid()
  listing_id String
  url        String
  alt        String?
  sort_order Int      @default(0)
  is_cover   Boolean  @default(false)
  created_at DateTime @default(now())
  listing    listings @relation(fields: [listing_id], references: [id], onDelete: Cascade)

  @@index([listing_id])
  @@index([listing_id, sort_order])
  @@index([listing_id, is_cover])
  @@map("listings_images")
}

model aimags {
  id         String      @id() @default(cuid())
  name       String
  name_en    String?
  code       String      @unique()
  type       AimagType   @default(aimag)
  sort_order Int         @default(0)
  is_active  Boolean     @default(true)
  created_at DateTime    @default(now())
  updated_at DateTime    @updatedAt()
  districts  districts[]

  @@index([code])
  @@index([is_active, sort_order])
  @@index([type])
  @@map("aimags")
}

model districts {
  id         String       @id() @default(cuid())
  aimag_id   String
  name       String
  name_en    String?
  type       DistrictType @default(duureg)
  sort_order Int          @default(0)
  is_active  Boolean      @default(true)
  created_at DateTime     @default(now())
  updated_at DateTime     @updatedAt()
  aimag      aimags       @relation(fields: [aimag_id], references: [id], onDelete: Cascade)
  khoroos    khoroos[]

  @@index([aimag_id])
  @@index([aimag_id, sort_order])
  @@index([is_active])
  @@index([type])
  @@map("districts")
}

model khoroos {
  id          String    @id() @default(cuid())
  district_id String
  name        String
  number      Int?
  sort_order  Int       @default(0)
  is_active   Boolean   @default(true)
  created_at  DateTime  @default(now())
  updated_at  DateTime  @updatedAt()
  district    districts @relation(fields: [district_id], references: [id], onDelete: Cascade)

  @@index([district_id])
  @@index([district_id, sort_order])
  @@index([is_active])
  @@index([number])
  @@map("khoroos")
}
